{"version":3,"sources":["../src/app.ts"],"sourcesContent":["import 'reflect-metadata';\nimport compression from 'compression';\nimport cookieParser from 'cookie-parser';\nimport cors from 'cors';\nimport express from 'express';\nimport helmet from 'helmet';\nimport hpp from 'hpp';\nimport morgan from 'morgan';\nimport swaggerJSDoc from 'swagger-jsdoc';\nimport swaggerUi from 'swagger-ui-express';\nimport { NODE_ENV, PORT, LOG_FORMAT, ORIGIN, CREDENTIALS } from '@config';\nimport { Routes } from '@interfaces/routes.interface';\nimport { ErrorMiddleware } from '@middlewares/error.middleware';\nimport { logger, stream } from '@utils/logger';\nimport {login} from \"./controllers/lensControllers/index.js\";\n\nexport class App {\n  public app: express.Application;\n  public env: string;\n  public port: string | number;\n\n  constructor(routes: Routes[]) {\n    this.app = express();\n    this.env = NODE_ENV || 'development';\n    this.port = PORT || 3000;\n\n    this.initializeMiddlewares();\n    this.initializeRoutes(routes);\n    this.initializeSwagger();\n    this.initializeErrorHandling();\n  }\n\n  public listen() {\n    this.app.listen(this.port, async () => {\n      logger.info(`=================================`);\n      logger.info(`======= ENV: ${this.env} =======`);\n      logger.info(`ðŸš€ App listening on the port ${this.port}`);\n      logger.info(`=================================`);\n      this.app.use(await login());\n    });\n  }\n\n  public getServer() {\n    return this.app;\n  }\n\n  private initializeMiddlewares() {\n    this.app.use(morgan(LOG_FORMAT, { stream }));\n    this.app.use(cors({ origin: ORIGIN, credentials: CREDENTIALS }));\n    this.app.use(hpp());\n    this.app.use(helmet());\n    this.app.use(compression());\n    this.app.use(express.json());\n    this.app.use(express.urlencoded({ extended: true }));\n    this.app.use(cookieParser());\n\n  }\n\n  private initializeRoutes(routes: Routes[]) {\n    routes.forEach(route => {\n      this.app.use('/', route.router);\n    });\n  }\n\n  private initializeSwagger() {\n    const options = {\n      swaggerDefinition: {\n        info: {\n          title: 'REST API',\n          version: '1.0.0',\n          description: 'Example docs',\n        },\n      },\n      apis: ['swagger.yaml'],\n    };\n\n    const specs = swaggerJSDoc(options);\n    this.app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(specs));\n  }\n\n  private initializeErrorHandling() {\n    this.app.use(ErrorMiddleware);\n  }\n}\n"],"names":["App","listen","app","port","logger","info","env","use","login","getServer","initializeMiddlewares","morgan","LOG_FORMAT","stream","cors","origin","ORIGIN","credentials","CREDENTIALS","hpp","helmet","compression","express","json","urlencoded","extended","cookieParser","initializeRoutes","routes","forEach","route","router","initializeSwagger","options","swaggerDefinition","title","version","description","apis","specs","swaggerJSDoc","swaggerUi","serve","setup","initializeErrorHandling","ErrorMiddleware","constructor","NODE_ENV","PORT"],"mappings":";;;;+BAgBaA;;;eAAAA;;;QAhBN;sDACiB;uDACC;+CACR;kDACG;iDACD;8CACH;iDACG;uDACM;2DACH;wBAC0C;iCAEhC;wBACD;uBACX;;;;;;;;;;;;;;;;;;;AAEb,IAAA,AAAMA,MAAN,MAAMA;IAgBJC,SAAS;QACd,IAAI,CAACC,IAAID,OAAO,IAAI,CAACE,MAAM;YACzBC,eAAOC,KAAK,CAAC,iCAAiC,CAAC;YAC/CD,eAAOC,KAAK,CAAC,aAAa,EAAE,IAAI,CAACC,IAAI,QAAQ,CAAC;YAC9CF,eAAOC,KAAK,CAAC,6BAA6B,EAAE,IAAI,CAACF,KAAK,CAAC;YACvDC,eAAOC,KAAK,CAAC,iCAAiC,CAAC;YAC/C,IAAI,CAACH,IAAIK,IAAI,MAAMC,IAAAA;QACrB;IACF;IAEOC,YAAY;QACjB,OAAO,IAAI,CAACP;IACd;IAEQQ,wBAAwB;QAC9B,IAAI,CAACR,IAAIK,IAAII,IAAAA,iBAAOC,oBAAY;YAAEC,QAAAA;QAAO;QACzC,IAAI,CAACX,IAAIK,IAAIO,IAAAA,eAAK;YAAEC,QAAQC;YAAQC,aAAaC;QAAY;QAC7D,IAAI,CAAChB,IAAIK,IAAIY,IAAAA;QACb,IAAI,CAACjB,IAAIK,IAAIa,IAAAA;QACb,IAAI,CAAClB,IAAIK,IAAIc,IAAAA;QACb,IAAI,CAACnB,IAAIK,IAAIe,iBAAQC;QACrB,IAAI,CAACrB,IAAIK,IAAIe,iBAAQE,WAAW;YAAEC,UAAU;QAAK;QACjD,IAAI,CAACvB,IAAIK,IAAImB,IAAAA;IAEf;IAEQC,iBAAiBC,MAAgB,EAAE;QACzCA,OAAOC,QAAQC,CAAAA;YACb,IAAI,CAAC5B,IAAIK,IAAI,KAAKuB,MAAMC;QAC1B;IACF;IAEQC,oBAAoB;QAC1B,MAAMC,UAAU;YACdC,mBAAmB;gBACjB7B,MAAM;oBACJ8B,OAAO;oBACPC,SAAS;oBACTC,aAAa;gBACf;YACF;YACAC,MAAM;gBAAC;aAAe;QACxB;QAEA,MAAMC,QAAQC,IAAAA,uBAAaP;QAC3B,IAAI,CAAC/B,IAAIK,IAAI,aAAakC,0BAAUC,OAAOD,0BAAUE,MAAMJ;IAC7D;IAEQK,0BAA0B;QAChC,IAAI,CAAC1C,IAAIK,IAAIsC;IACf;IA7DAC,YAAYlB,MAAgB,CAAE;QAJ9B,uBAAO1B,OAAP,KAAA;QACA,uBAAOI,OAAP,KAAA;QACA,uBAAOH,QAAP,KAAA;QAGE,IAAI,CAACD,MAAMoB,IAAAA;QACX,IAAI,CAAChB,MAAMyC,oBAAY;QACvB,IAAI,CAAC5C,OAAO6C,gBAAQ;QAEpB,IAAI,CAACtC;QACL,IAAI,CAACiB,iBAAiBC;QACtB,IAAI,CAACI;QACL,IAAI,CAACY;IACP;AAqDF"}